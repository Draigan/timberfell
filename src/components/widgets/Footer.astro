---
import { SITE } from 'astrowind:config';
import { getHomePermalink } from '~/utils/permalinks';

interface Link {
  text?: string;
  href?: string;
}

export interface Props {
  secondaryLinks?: Array<Link>;
  footNote?: string;
  theme?: string;
}

const {
  secondaryLinks = [],
  footNote = 'Made by Draigan All rights reserved',
  theme = 'light',
} = Astro.props as Props;

const baseLinks = [
  { text: 'Home', href: '/' },
  { text: 'Services', href: '/services' },
  { text: 'About', href: '/about' },
  { text: 'Contact', href: '/contact' },
  { text: 'Blog', href: '/blog' },
];

const quickLinks = [...baseLinks, ...(secondaryLinks ?? [])];
const uniqueQuickLinks = Array.from(
  new Map(quickLinks.map((link) => [link.href ?? link.text ?? '#', link])).values()
);

const serviceAreas = ['Lindsay', 'Peterborough', 'Bobcaygeon', 'Fenelon Falls', 'Kawartha Lakes townships'];
---

<footer class:list={[{ dark: theme === 'dark' }, 'relative border-t border-gray-200 dark:border-slate-800 not-prose']}>
  <div class="dark:bg-dark absolute inset-0 pointer-events-none" aria-hidden="true"></div>
  <div class="relative max-w-7xl mx-auto px-4 sm:px-6 py-12 dark:text-slate-300 space-y-10 intersect-once intersect-quarter intersect-no-queue motion-safe:md:opacity-0 motion-safe:md:intersect:animate-fade">
    <div class="grid grid-cols-1 gap-10 text-[0.95rem] leading-relaxed text-muted md:grid-cols-4 md:text-base">
      <div class="space-y-5">
        <a class="inline-block font-bold text-2xl text-gray-900 dark:text-white" href={getHomePermalink()}>{SITE?.name}</a>
        <p class="max-w-sm text-muted/90">ISA-certified tree care for homes and businesses across Kawartha Lakes, delivered with safety, precision, and respect for every property.</p>
        <div class="space-y-2">
          <p class="text-sm font-semibold uppercase tracking-[0.3em] text-accent/80">Quick Links</p>
          <ul class="flex flex-wrap gap-3 text-sm font-semibold uppercase tracking-wide text-muted/80">
            {uniqueQuickLinks.map(({ text, href }) => (
              <li>
                <a class="hover:text-gray-700 dark:hover:text-gray-200 transition duration-150 ease-in-out" href={href}>
                  {text}
                </a>
              </li>
            ))}
          </ul>
        </div>
      </div>
      <div class="space-y-4">
        <p class="text-sm font-semibold uppercase tracking-[0.3em] text-accent/80">Contact</p>
        <div class="space-y-2 text-muted/90">
          <p>
            Phone: <a class="font-semibold text-gray-900 dark:text-white" href="tel:+17053345678">(705) 334-5678</a>
          </p>
          <p>
            Email: <a class="font-semibold text-gray-900 dark:text-white hover:text-accent" href="mailto:hello@timberfell.ca">hello@timberfell.ca</a>
          </p>
          <p>Mon–Sat · 8:00–18:00</p>
          <p>Emergency crews on call 24/7</p>
        </div>
      </div>
      <div class="space-y-4">
        <p class="text-sm font-semibold uppercase tracking-[0.3em] text-accent/80">Service Area</p>
        <ul class="grid grid-cols-2 gap-2 text-muted/90">
          {serviceAreas.map((area) => (
            <li>{area}</li>
          ))}
        </ul>
        <p class="text-muted/90">Fully insured &amp; WSIB covered for residential and commercial work.</p>
      </div>
      <div class="space-y-4">
        <p class="text-sm font-semibold uppercase tracking-[0.3em] text-accent/80">Credentials</p>
        <ul class="space-y-2 text-muted/90">
          <li>ISA-certified arborists on every crew</li>
          <li>Modern aerial lift &amp; rigging equipment</li>
          <li>Safety-first process from assessment to cleanup</li>
        </ul>
        <div class="flex flex-wrap gap-3 pt-3">
          <span class="inline-flex items-center gap-2 rounded-full border border-accent/30 bg-accent/10 px-3 py-1.5 text-xs font-semibold text-accent">
            <span class="h-2.5 w-2.5 rounded-full bg-accent"></span>
            ISA Certified Arborist #ON-1245A
          </span>
          <span class="inline-flex items-center gap-2 rounded-full border border-accent/30 bg-accent/10 px-3 py-1.5 text-xs font-semibold text-accent">
            <span class="h-2.5 w-2.5 rounded-full bg-accent"></span>
            Fully Insured &amp; WSIB Covered
          </span>
          <span class="inline-flex items-center gap-2 rounded-full border border-accent/30 bg-accent/10 px-3 py-1.5 text-xs font-semibold text-accent">
            <span class="h-2.5 w-2.5 rounded-full bg-accent"></span>
            24/7 Emergency Dispatch
          </span>
        </div>
      </div>
    </div>

    <div class="border-t border-gray-200 pt-6 text-center text-sm text-muted dark:border-slate-700">
      <Fragment set:html={footNote} />
    </div>
  </div>
</footer>
